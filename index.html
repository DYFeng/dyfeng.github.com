
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>DY.Feng's Blog 叶毅锋的博客</title>
  
  <meta name="description" content="Using Octopress as Github Blog on Ubuntu 12.04 Aug 12th, 2012 Tags: github, octopress 本来我的Github blog是使用Jekyll-Bootstrap作为生成引擎。不过他是把文章发给Github解析的， &hellip;" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <link rel="stylesheet" href="/stylesheets/screen.css" />
  <link rel="stylesheet" href="/stylesheets/pygments.css" />
  
  <link rel="alternate" href="/atom.xml" type="application/atom+xml" />
  
</head>

<body>
<!--[if IE]>
html,body{height:100%;overflow:hidden}
<div class="ie-go-away">My blog does not support the IE!</div>
<![endif]-->

<!-- 黑长直 -->
<nav class="black-long-straight">
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/blog/archives">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li><a href="/about">About Me</a></li>
    
    <li>
      <form action="http://google.com/search" method="get" target="_blank">
        <input type="hidden" name="q" value="site:www.dyfeng.org" />
        <input type="text" name="q" class="search" placeholder="Search" x-webkit-speech />
      </form>
    </li>
    
  </ul>
</nav>

<header class="my-nickname"><em title="">(≧▼≦) 喵喵</em></header>

<section class="main-wrap clearfix">
  
  
  
    <article>
      

<header>
  
    <h1 class="entry-title"><a href="/2012/08/12/using-octopress-as-github-blog/">Using Octopress as Github Blog on Ubuntu 12.04</a></h1>
  
  
    <p class="meta">
      








  


<time datetime="2012-08-12T00:00:00+08:00" pubdate="pubdate" data-updated="true">Aug 12<span>th</span>, 2012</time>
      

<span class="tags">
  Tags:
  
    <a href='//github/'>github</a>, <a href='//octopress/'>octopress</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=&amp;title=Using Octopress as Github Blog on Ubuntu 12.04 - &amp;url=http://www.dyfeng.org/2012/08/12/using-octopress-as-github-blog/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=Using Octopress as Github Blog on Ubuntu 12.04 - &amp;url=http://www.dyfeng.org/2012/08/12/using-octopress-as-github-blog/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=Using Octopress as Github Blog on Ubuntu 12.04 - http://www.dyfeng.org/2012/08/12/using-octopress-as-github-blog/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
</header>


  <div class="entry-content typo"><p>本来我的Github blog是使用<code>Jekyll-Bootstrap</code>作为生成引擎。不过他是把文章发给Github解析的，由于Github出于安全考虑，限制ruby脚本的运行，这样就导致很多功能实现不了。这时候我发现了<code>Octopress</code>引擎，他把你的branch分成两个，一个master，负责放置静态的页面，一个是source，放置程序本身和Markdown日志。</p>

</div>
  
  
    <footer class="align-r">
      <a href="/2012/08/12/using-octopress-as-github-blog/#ContinueReading">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      

<header>
  
    <h1 class="entry-title"><a href="/2012/08/11/first-post-on-github/">First Post on Github</a></h1>
  
  
    <p class="meta">
      








  


<time datetime="2012-08-11T00:00:00+08:00" pubdate="pubdate" data-updated="true">Aug 11<span>th</span>, 2012</time>
      

<span class="tags">
  Tag:
  
    <a href='//github/'>github</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=&amp;title=First Post on Github - &amp;url=http://www.dyfeng.org/2012/08/11/first-post-on-github/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=First Post on Github - &amp;url=http://www.dyfeng.org/2012/08/11/first-post-on-github/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=First Post on Github - http://www.dyfeng.org/2012/08/11/first-post-on-github/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
</header>


  <div class="entry-content typo"><p>Included file &#8216;JB/setup&#8217; not found in _includes directory</p>

<p>终于出炉了！！这是我第一篇用github做blog的文章！！小生愚钝，在Win7下弄了4个小时才弄出来。遇到了cygwin和gem不兼容、gem源被墙、jekyll在Win7下各种奇怪的症状&#8230;得感叹下在Windows下生活的孩子不容易吖。</p>

<p>因为在Windows下操作，入乡随俗地下载了个Github的Windows客户端，那界面很炫，很有Win8 feel，难道这就是传说中的WinForm。可惜就是push的时候太慢了点，感觉要比命令行下要慢半拍。而且他在界面里不叫push，叫sync，这个名词更容易让人理解。</p>

<p>下面是各种华丽的Markdown测试</p>

<pre class="prettyprint">
require 'redcarpet'
markdown = Redcarpet.new("Hello World!")
puts markdown.to_html
</pre>




<pre class="prettyprint">
##大标题
###小标题
####小小标题
#####小小小标题
######你还能再小点不
#######其实我能一直地小，只是css没有定义到了
</pre>


<h2>大标题</h2>

<h3>小标题</h3>

<h4>小小标题</h4>

<h5>小小小标题</h5>

<h6>你还能再小点不</h6>

<h6>#其实我能一直地小，只是css没有定义到了</h6>

<pre class="prettyprint">
*强调一下*

**再强调一下**

***我次次强调我容易吗我***
</pre>


<p><em>强调一下</em></p>

<p><strong>再强调一下</strong></p>

<p><strong><em>我次次强调我容易吗我</em></strong></p>
</div>
  
  


    </article>
  
  
    <article>
      

<header>
  
    <h1 class="entry-title"><a href="/2012/08/11/decrease-threads-with-xampp/">减少xampp内存占用</a></h1>
  
  
    <p class="meta">
      








  


<time datetime="2012-08-11T00:00:00+08:00" pubdate="pubdate" data-updated="true">Aug 11<span>th</span>, 2012</time>
      

<span class="tags">
  Tags:
  
    <a href='//linux/'>linux</a>, <a href='//xampp/'>xampp</a>, <a href='//apache/'>apache</a>, <a href='//moodle/'>moodle</a>
  
</span>

      <span class="share-to-weibo">
        <a href="javascript:void(0)" onclick="window.open('http://service.weibo.com/share/share.php?appkey=&amp;ralateUid=&amp;title=减少xampp内存占用 - &amp;url=http://www.dyfeng.org/2012/08/11/decrease-threads-with-xampp/', null, 'width=615,height=505,toolbar=0,status=0')" class="sina-weibo" title="分享到新浪微博"></a>

        <a href="javascript:void(0)" onclick="window.open('http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;appkey=&amp;title=减少xampp内存占用 - &amp;url=http://www.dyfeng.org/2012/08/11/decrease-threads-with-xampp/', null, 'width=700,height=680,toolbar=0,status=0')" class="tencent-weibo" title="分享到腾讯微博"></a>

        <a href="javascript:void(0)" onclick="window.open('https://twitter.com/intent/tweet?text=减少xampp内存占用 - http://www.dyfeng.org/2012/08/11/decrease-threads-with-xampp/', null, 'width=600,height=300,toolbar=0,status=0')" class="twitter" title="分享到Twitter"></a>
      </span>
    </p>
  
</header>


  <div class="entry-content typo"><p>Included file &#8216;JB/setup&#8217; not found in _includes directory</p>

<h2>特别长的前话</h2>

<p>最近有个改写moodle系统插件的项目，所以我又重操起php的老行当。moodle是一个非常不错的考试系统，多种题型，多种计分方式，唯一的缺点就是文档太少，非常的缺&#8230;开发人员列表里面也看到了好几个中国人的名字。</p>

<p>下载，放到htdocs，<code>sudo lampp start</code>，结果发现他竟然要求php5.3以上。我的php还是5.1的老版本，那没法，唯有下载个最新的xampp吧。一切还算顺利，除了xampp好像怪怪的。因为我改了配置文件后，再重启，他竟然好像没有反应，这个到现在还是个不解之谜。</p>

<p>在开发的过程中，我还发现电脑卡了很多，<code>ps -A|grep httpd</code>一看，哇的一刷。内存给我用了几百兆了，虽然我有4G也不是这样浪费的嘛，我只是开发而已，没有必要开这么线程。下面记录一下给xampp减少线程的方法。</p>

<h2>减少xampp线程数，享受低碳生活</h2>

<h3>先看看Apache现在是在什么模式下工作</h3>

<pre><code>feng@feng:/opt/lampp$ /opt/lampp/bin/apachectl -lCompiled in modules:
core.c
prefork.c
http_core.c
mod_so.c
</code></pre>

<p>看到了吧，原来xampp的Apache默认是在<em>prefork</em>模式下跑的，那我们得相应修改prefox模式的进程数。</p>

<h3>修改Apache配置</h3>

<h4>修改httpd.conf</h4>

<pre><code>feng@feng:/opt/lampp$ vim etc/httpd.conf
</code></pre>

<p>找到<code>#Include etc/extra/httpd-mpm.conf</code>去掉注释，保存。</p>

<h4>修改httpd-mpm.conf</h4>

<pre><code>feng@feng:/opt/lampp$ vim etc/extra/httpd-mpm.conf 
</code></pre>

<p>找到</p>

<pre><code>&lt;IfModule mpm_prefork_module&gt;
StartServers          2
MinSpareServers       2
MaxSpareServers      5
MaxClients          5
MaxRequestsPerChild   0
&lt;/IfModule&gt;
</code></pre>

<p>修改其中的参数，下面是这几个参数的详细解释：</p>

<p>Apache一开始会新建<em>StartServers</em>个子进程后，为了满足<em>MinSpareServers</em>设置的需要，创建一个进程，等待一秒钟，继续创建两个，再等待一秒钟，继续创建四个……如此按指数级增加创建的进程数，最多达到每秒32个，直到满足<em>MinSpareServers</em>设置的值为止。</p>

<p>这种模式可以不必在请求到来时再产生新的进程，从而减小了系统开销以增加性能。<em>MaxSpareServers</em>设置了最大的空闲进程数，如果空闲进程数大于这个值，Apache会自动kill掉一些多余进程。这个值不要设得过大，但如果设的值比MinSpareServers小，Apache会自动把其调整为 MinSpareServers+1。</p>

<p>如果站点负载较大，可考虑同时加大<em>MinSpareServers</em>和<em>MaxSpareServers</em>。 <em>MaxRequestsPerChild</em>设置的是每个子进程可处理的请求数。每个子进程在处理了<em>MaxRequestsPerChild</em>个请求后将自动销毁。0意味着无限，即子进程永不销毁。虽然缺省设为0可以使每个子进程处理更多的请求，但如果设成非零值也有两点重要的好处：</p>

<blockquote><ol>
<li>可防止意外的内存泄漏。</li>
<li>在服务器负载下降的时侯会自动减少子进程数。</li>
</ol>
</blockquote>

<p>因此，可根据服务器的负载来调整这个值。<em>MaxClients</em>是这些指令中最为重要的一个，设定的是 Apache可以同时处理的请求，是对Apache性能影响最大的参数。其缺省值150是远远不够的，如果请求总数已达到这个值（可通过<code>ps -ef|grep http|wc -l</code>来确认），那么后面的请求就要排队，直到某个已处理请求完毕。这就是系统资源还剩下很多而HTTP访问却很慢的主要原因。虽然理论上这个值越大，可以处理的请求就越多，但Apache默认的限制不能大于256。</p>
</div>
  
  


    </article>
  

  
</section>


<footer class="footer">
  &copy;2012 (≧▼≦) 喵喵
  &nbsp;-&nbsp;
  Powered by <a href="http://octopress.org" target="_blank">Octopress</a>
</footer>


<ul id="social-links">
  
  
  
  
</ul>

<script src="/javascripts/application.js"></script>


<iframe src="/offline-cache.html" style="display:none"></iframe>
</body>
</html>