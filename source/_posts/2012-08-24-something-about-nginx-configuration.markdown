---
layout: post
title: "关于nginx的一些配置"
date: 2012-08-24 01:10
comments: true
categories: server
tags: [ nginx ]
---

今天帮人配置了下nginx，主要是二级域名以对应文件夹为根目录。主要的问题是在`Windows`环境下配置的，而小生一直都是在`Linux`环境下工作的，对`Windows`不大了解，记录下今天学到的小技巧。
<!-- more -->
#使用lvh.me做域名调试

因为我要配置二级域名，而我手头又没有域名，所以配置写起来很麻烦。其中一个方法是改`host`文件，可在我的XP里却死活不行，host文件改了跟没改一样，又没有开什么杀毒软件之类的，对Windows甚为不解。

好在有人免费提供了一些指向`127.0.0.1`的域名，`lvh.me`就是其中的一个。用他来调试nginx域名配置就最好不过了。

#nginx配置的

- nginx的`IF`语句没有ELSE，判断语句里面没有&&和||，你别想多了，他就是一个`IF`而已。

如果要用到多个逻辑判断怎么办？没有&&又没有||。我们来设置一个标记`$flag`


```
set $flag 'test';

if ( 条件一 ){
set $flag '';
}

if ( 条件二 ){
set $flag '';
}

if ( $flag = 'test' ){
做点什么;
}
```

等价于

```
if ( !条件一 && !条件二 ){
做点什么
}
```

所有的逻辑语句都可以用这种标记法来实现。

- 文件和目录判断，linux下好像-f也能判断目录，我今天就栽在这个上了。
  - -f和!-f判断是否存在文件
  - -d和!-d判断是否存在目录
  - -e和!-e判断是否存在文件或目录
  - -x和!-x判断文件是否可执行

- nginx配置文件的字符串比较。要注意一点，nginx的字符串都是按正则使用的。
  - 匹配         
    - 区分大小写 `~`
    - 不区分大小写 `~*`
    - 精确匹配 `=`
  - 不匹配。前面加`!`
    - 区分大小写 `!~`
    - 不区分大小写 `!~*`
    - 精确匹配 `!=`


